152:153
(nrow(data)-1):nrow(data)
data[(nrow(data)-1:nrow(data)),]
data[(nrow(data)-1:nrow(data)),]
data[152:153,]
data[47,"Ozone"]
sum(as.integer(is.na(data[,"Ozone"])))
x<-c(10, NA, 20)
x
mean(x)
y=T
!Y
!y
mean(data[!is.na(data[,"Ozone"]), "Ozone"])
mean(data[data[,"Month"]==6], "Temp")
mean(data[data[,"Month"]==6], "Temp"])
mean(data[,data[,"Month"]==6], "Temp"])
data[,"Month"]==6]
data[,"Month"]==6
mean(data[data[,"Month"]==6, "Temp"])
x
max(x0)
max(x)
max(x[!is.na(x)])
max(data[data[,"Month"]==5,"Ozone"])
max(data[data[,"Month"]==5 && !is.na(data[, "Ozone"]),"Ozone"])
x=c(1,1,0,1,0)
y=c(0,1,1,0,1)
x&&y
x&y
max(data[data[,"Month"]==5 & !is.na(data[, "Ozone"]),"Ozone"])
mean(data[data[,"Temp"]>90 & data[!is.na(data[,"Ozone"]), "Ozone">31], "Solar.R"])
mean(data[!is.na(data[,"Solar.R]) & data[,"Temp"]>90 & data[!is.na(data[,"Ozone"]), "Ozone">31], "Solar.R"])
mean(data[!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[!is.na(data[,"Ozone"]), "Ozone">31], "Solar.R"])
!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[!is.na(data[,"Ozone"]), "Ozone">31
!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[!is.na(data[,"Ozone"]), "Ozone">31]
data
tmp<-data[,"Temp"]>90 & data[!is.na(data[,"Ozone"]), "Ozone">31]
tmp
data[!is.na(data[,"Ozone"]), "Ozone">31]
data[!is.na(data[,"Ozone"]), "Ozone">=32]
data[, "Ozone"]>=32
mean(data[!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[!is.na(data[,"Ozone"]), "Ozone"]>31], "Solar.R"])
data[!is.na(data[,"Ozone"]), "Ozone"]>31
data[,"Temp"]>90
data[,"Ozone"]>31
mean(data[!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[,"Ozone"], "Ozone"]>31], "Solar.R"])
mean(data[!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[,"Ozone"], "Ozone"]>31, "Solar.R"])
mean(data[!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[,"Ozone"]>31, "Solar.R"])
data[,"Temp"]>90 & data[,"Ozone"]>31
is.true(data[,"Temp"]>90 & data[,"Ozone"]>31)
true(data[,"Temp"]>90 & data[,"Ozone"]>31)
as.integer(data[,"Temp"]>90 & data[,"Ozone"]>31)
!is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[,"Ozone"]>31
x <- !is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[,"Ozone"]>31
x[is.na(x)] <-F
x
x <- !is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[,"Ozone"]>31
x
x <- !is.na(data[,"Solar.R"]) & data[,"Temp"]>90 & data[,"Ozone"]>31
x[is.na(x)] <-F
mean(data[x, "Solar.R"])
set.seed(1)
rpois(5, 2)
set.seed(1)
rpois(5, 2)
set.seed(1)
rpois(5, 2)
?qpois
rpois
?rpois
set.seed(10)
x <- rep(0:1, each = 5)
e <- rnorm(10, 0, 20)
y <- 0.5 + 2 * x + e
plot(x,y)
a = rbinom(10)
?rbinom
library(datasets)
Rprof()
fit <- lm(y ~ x1 + x2)
Rprof(NULL)
summaryRprof()
system.time()
system.time(1)
system.time(1)
system.time(end)
?par
?dev.copy2pdf
library(nlme)
library(lattice)
xyplot(weight ~ Time | Diet, BodyWeight)
library(lattice)
library(datasets)
data(airquality)
p <- xyplot(Ozone ~ Wind | factor(Month), data = airquality)
print(p)
library(datasets)
data(airquality)
qplot(Wind, Ozone, data = airquality)
library(ggplot2)
library(datasets)
data(airquality)
qplot(Wind, Ozone, data = airquality)
install.packages("ggplot2")
library(ggplot2)
library(datasets)
data(airquality)
qplot(Wind, Ozone, data = airquality)
airquality = transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month)
qplot(Wind, Ozone, data = airquality, geom = "smooth")
qplot(Wind, Ozone, data = airquality)
qplot(Wind, Ozone, data = airquality, geom = "smooth")
qplot(Wind, Ozone, data = airquality, facets = . ~ factor(Month))
airquality = transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month)
airquality = transform(airquality, Month = factor(Month))
qplot(Wind, Ozone, data = airquality, facets = . ~ Month)
library(ggplot2)
g <- ggplot(movies, aes(votes, rating))
print(g)
ggplot(movies, aes(votes, rating))
qplot(votes, rating, data = movies)
qplot(votes, rating, data = movies, panel = panel.loess)
qplot(votes, rating, data = movies) + geom_smooth()
qplot(votes, rating, data = movies) + stats_smooth("loess")
qplot(votes, rating, data = movies, smooth = "loess")
qplot(votes, rating, data = movies) + geom_smooth()
setwd("C:/CodeRepo/R/ReproducibleResearch/RepData_PeerAssessment1")
data = read.csv(".\activity.zip\activity.csv")
data = read.csv("./activity.zip/activity.csv")
data = read.csv("./data/activity.csv")
View(data)
data$date
totalStep = sum(data$steps by data$date)
library(data.table)
library(ggplot2)
library(data.table)
library(ggplot2)
data = data.table(read.csv("./data/activity.csv"))
View(data)
totalStep = data[, lapply(.SD, sum), by = date]
View(totalStep)
View(data)
ggplot(stepsPerDay, aes(x=steps)) + geom_histogram(binwidth=.5)
stepsPerDay = data[, lapply(.SD, sum), by = date]
ggplot(stepsPerDay, aes(x=steps)) + geom_histogram(binwidth=.5)
stepsPerDay = data[, lapply(.SD, sum), by = date]
ggplot(stepsPerDay, aes(x=date)) + geom_histogram(binwidth=.5)
ggplot(stepsPerDay$steps, aes(x=1:61)) + geom_histogram(binwidth=.5)
stepsPerDay = stepsPerDay[,day:=1:61]
View(stepsPerDay)
ggplot(stepsPerDay$steps, aes(day)) + geom_histogram(fill=NA, color="black") + theme_bw()
stepsPerDay = stepsPerDay[,day:=as.factor(1:61)]
ggplot(stepsPerDay$steps, aes(day)) + geom_histogram(fill=NA, color="black") + theme_bw() stepsPerDay = data[, lapply(.SD, sum), by = date]
stepsPerDay = stepsPerDay[,day:=as.factor(1:61)]
ggplot(stepsPerDay$steps, aes(day)) + geom_histogram(fill=NA, color="black") + theme_bw()
View(stepsPerDay)
stepsPerDay = data[, lapply(.SD, sum), by = date]
View(stepsPerDay)
stepsPerDay = stepsPerDay[,day:=as.factor(1:61)]
View(stepsPerDay)
str(stepsPerDay)
ggplot(stepsPerDay$steps, aes(x=day)) + geom_histogram(fill=NA, color="black") + theme_bw()
ggplot(stepsPerDay, aes(x=day)) + geom_histogram(fill=NA, color="black") + theme_bw()
ggplot(stepsPerDay, aes(x=day, y=steps)) + geom_histogram(fill=NA, color="black") + theme_bw()
ggplot(stepsPerDay, aes(x=day)) + geom_histogram(fill=NA, color="black",stat="bin") + theme_bw()
ggplot(stepsPerDay, aes(x=day,stat="bin")) + geom_histogram(fill=NA, color="black",stat="bin") + theme_bw()
qplot(stepsPerDay$day, y = stepsPerDay$steps, geom = "histogram")
qplot(stepsPerDay$day, y = stepsPerDay$steps, geom = "bar")
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar()
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity")
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",position=position_dodge(0))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",position=position_dodge(0.1))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1)
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1) + theme_bw()
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="white") + theme_bw()
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="white") + theme_bw() + scale_x_continuous( breaks=c(seq(1,61,by=5)
)
)))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="white") + theme_bw() + scale_x_continuous( breaks=c(seq(1,61,by=5)))
breaks=c(seq(1,61,by=5))
breaks=c(1,seq(5,61,by=5))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="white") + theme_bw() + scale_x_continuous( breaks=c(1,seq(5,61,by=5), 61))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="white") + theme_bw()
scale_x_continuous( breaks=c(1,seq(5,61,by=5), 61))
+ scale_x_continuous( breaks=c(1,seq(5,61,by=5), 61))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="white") + theme_bw() +
scale_x_discrete( breaks=c(1,seq(5,61,by=5), 61))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="white") + theme_bw() +
scale_x_discrete( breaks=c(1,seq(5,55,by=5), 61))
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) + geom_bar(stat = "identity",width=1,colour="black", fill="grey") + theme_bw() +
scale_x_discrete( breaks=c(1,seq(5,55,by=5), 61))
data = data.table(read.csv("./data/activity.csv"))
data$date = as.date(data$date)
View(stepsPerDay)
data$date = as.Date(data$date)
View(data)
ggplot(stepsPerDay, stat="identity", aes(x=day, y=steps)) +
geom_bar(stat = "identity",width=1,colour="black", fill="grey") +
scale_x_discrete( breaks=c(1,seq(5,55,by=5), 61)) +
theme_bw()
meanSteps = mean(stepsPerDay$steps, rm.na = TRUE)
meanSteps = mean(stepsPerDay$steps, na.rm= TRUE)
stepsPerDay = data[, lapply(.SD, sum), by = date]
stepsPerDay = stepsPerDay[,day:=as.factor(1:61)]
stepsPerPeriod = data[, lapply(.SD, sum), by = interval]
View(stepsPerPeriod)
stepsPerPeriod = data[, lapply(.SD, sum), by = interval]
stepsPerPeriod = data[, lapply(.SD, sum(na.rm = TRUE)), by = interval]
View(stepsPerPeriod)
stepsPerPeriod = data[, lapply(.SD, sum, na.rm = TRUE), by = interval]
floor(sum(stepsPerDay$steps, na.rm= TRUE)/length(unique(stepsPerDay$date)))
ggplot2(stepsPerPeriod, aes(x=interval, y=steps)) + geom_line()
ggplot(stepsPerPeriod, aes(x=interval, y=steps)) + geom_line()
ggplot(stepsPerPeriod, aes(x=interval, y=steps)) +
geom_line() +
theme_bw()
View(data)
as.POSIXct(date$inteval, format = 'hhmm')
ggplot(stepsPerPeriod, aes(x=1:228, y=steps)) +
geom_line() +
theme_bw()
ggplot(stepsPerPeriod, aes(x=c(1:228), y=steps)) +
geom_line() +
theme_bw()
ggplot(stepsPerPeriod, aes(x=c(1:length(stepsPerPeriod$interval)), y=steps)) +
geom_line() +
theme_bw()
tmpTime = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(date$interval))
temp <- c(0 ,  5 , 10,  15  ,20 , 25  ,30  ,35,  40,  45 , 50  ,55 ,100 ,105, 110) # Your data
temp2 <- mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(temp))
temp <- paste0(temp2, temp)
temp
temp = data$interval
temp2 <- mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(temp))
temp <- paste0(temp2, temp)
temp
format(strptime(temp, format="%H%M"), format = "%H:%M")
data[,time:=format(strptime(tmpTime, format = "%H%M"), format = "%H%M")]tmpTime = data$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
data[,time:=format(strptime(tmpTime, format = "%H%M"), format = "%H%M")]
tmpTime = data$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
data[,time:=format(strptime(tmpTime, format = "%H%M"), format = "%H%M")]
View(data)
format(strptime(tmpTime, format = "%H%M"), format = "%H%M")
data[,time:=format(strptime(tmpTime, format = "%H%M"), format = "%H:%M")]
View(data)
stepsPerPeriod = data[, lapply(.SD, sum, na.rm = TRUE), by = interval]
ggplot(stepsPerPeriod, aes(x=time, y=steps)) +
geom_line() +
theme_bw()
View(stepsPerPeriod)
stepsPerPeriod = data[, lapply(.SD, sum, na.rm = TRUE), by = interval]
# Load data
data = data.table(read.csv("./data/activity.csv"))
data$date = as.Date(data$date) # Convert date factor to date
stepsPerPeriod = data[, lapply(.SD, sum, na.rm = TRUE), by = interval]
tmpTime = stepsPerPeriod$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
stepsPerPeriod[,time:=format(strptime(tmpTime, format = "%H%M"), format = "%H:%M")]
ggplot(stepsPerPeriod, aes(x=time, y=steps)) +
geom_line() +
theme_bw()
tmpTime = data$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
data[,time:=as.POSTIXct(format(strptime(tmpTime, format = "%H%M"), format = "%H:%M"), format='%H:%M')]
data[,time:=as.POSIXct(format(strptime(tmpTime, format = "%H%M"), format = "%H:%M"), format='%H:%M')]
View(data)
stepsPerPeriod = data[, lapply(.SD, sum, na.rm = TRUE), by = interval]
ggplot(stepsPerPeriod, aes(x=time, y=steps)) +
geom_line() +
theme_bw()
stepsPerPeriod = data[, lapply(.SD, sum, na.rm = TRUE), by = interval]
tmpTime = stepsPerPeriod
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
tmpTime = stepsPerPeriod$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
tmpTime = format(strptime(tmpTime, format = "%H%M"), format = "%H:%M")
ggplot(stepsPerPeriod, aes(x=seq(1, length(stepsPerPeriod$interval,1)) y=steps)) +
geom_line() +
theme_bw()
ggplot(stepsPerPeriod, aes(x=seq(1, length(stepsPerPeriod$interval,1)), y=steps)) +
geom_line() +
theme_bw()
ggplot(stepsPerPeriod, aes(x=seq(1, length(stepsPerPeriod$interval),1), y=steps)) +
geom_line() +
theme_bw()
288/12
ggplot(stepsPerPeriod, aes(x=seq(1, length(stepsPerPeriod$interval),1), y=steps)) +
geom_line() +
scale_x_continuous(breaks = seq(1,length(stepsPerPeriod$interval), 12)) +
theme_bw()
ggplot(stepsPerPeriod, aes(x=seq(1, length(stepsPerPeriod$interval),1), y=steps)) +
geom_line() +
scale_x_continuous(breaks = seq(1,length(stepsPerPeriod$interval), 24)) +
theme_bw()
ggplot(stepsPerPeriod, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
scale_x_continuous(breaks = seq(1,sizeX, 24), labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw()
sizeX = length(stepsPerPeriod$interval)
ggplot(stepsPerPeriod, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
scale_x_continuous(breaks = seq(1,sizeX, 24), labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw()
seq(1,sizeX, 24)
ggplot(stepsPerPeriod, aes(x=seq(0, sizeX,1), y=steps)) +
geom_line() +
scale_x_continuous(breaks =seq(0,sizeX, 24) , labels=tmpTime[seq(0,sizeX,24)]) +
theme_bw()
seq(0,sizeX, 24)
seq(0,sizeX,24)
ggplot(stepsPerPeriod, aes(x=seq(0, sizeX,1), y=steps)) +
geom_line() +
scale_x_continuous(breaks =seq(0,sizeX, 24) , labels=tmpTime[seq(0,sizeX,24)]) +
theme_bw()
breaks =seq(0,sizeX, 24)
labels=tmpTime[seq(0,sizeX,24)]
tmpTime
ggplot(stepsPerPeriod, aes(x=seq(0, sizeX,1), y=steps)) +
geom_line() +
scale_x_continuous(breaks = seq(1,sizeX, 24) , labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw()
ggplot(stepsPerPeriod, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
scale_x_continuous(breaks = seq(1,sizeX, 24) , labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw()
ggplot(stepsPerPeriod, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
scale_x_continuous(breaks = seq(1,sizeX, 24) , labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw() +
xlab("Time")
dataIsNA = data[is.na(steps)]
data[is.na(steps), steps]
stepsPerPeriod$steps[c(1,1,1,1)]
data[is.na(steps), interval]
stepsPerPeriod[interval == data[is.na(steps), interval], steps]
data[is.na(steps), steps] = stepsPerPeriod[interval == data[is.na(steps), interval], steps]
data[is.na(steps), steps]
stepsPerPeriod[interval == data[is.na(steps), interval], steps]
stepsPerPeriod[interval == data[is.na(steps), interval], steps]
data[is.na(steps), interval]
apply(data[,steps], function(y){
y[is.na(y)] = mean(y, na.rm = TRUE)
return(y)
}])
apply(data[,steps], function(y){
y[is.na(y)] = mean(y, na.rm = TRUE)
return(y)
})
is.na(data$steps)
idx = which(is.na(data$steps)), arr.ind = FALSE, useNames = TRUE)
i in 1
i = 1
is.na(data$steps[i])
data$steps[i]
stepPerPeriod[interval == data$interval[i], steps]
stepsPerPeriod[interval == data$interval[i], steps]
interval == data$interval[i]
numNA = sum(as.numeric(is.na(data$steps)))
numNA
data2$steps[i]
data2 = data
numNA = sum(as.numeric(is.na(data$steps)))
maxInterval = statsPerPeriod[statsPerPeriod$steps == max(statsPerPeriod$steps), interval]
stepsPerPeriod = data[, lapply(.SD, mean, na.rm = TRUE), by = interval]
maxInterval = statsPerPeriod[statsPerPeriod$steps == max(statsPerPeriod$steps), interval]
maxInterval = stepsPerPeriod[stepsPerPeriod == max(stepsPerPeriod), interval]
maxInterval = stepsPerPeriod[stepsPerPeriod$steps == max(stepsPerPeriod$steps), interval]
maxInterval = tmpTime[stepsPerPeriod$steps == max(stepsPerPeriod$steps)]
test = weekdays(data$date)
medianSteps = floor(median(stepsPerDat$steps, na.rm = TRUE))
medianSteps = floor(median(stepsPerDay$steps, na.rm = TRUE))
meanSteps = floor(sum(stepsPerDay$steps, na.rm= TRUE)/length(unique(stepsPerDay$date)))
View(data2)
data = data.table(read.csv("./data/activity.csv"))
data$date
as.factor(data$date)
weekFactor = factor(as.numeric(tmpDays == "Saturday" || tmpDays == "Sunday") + 1,
labels = c("Weekend", "Weekday"))
tmpDays = weekdays(data$date)
weekFactor = factor(as.numeric(tmpDays == "Saturday" || tmpDays == "Sunday") + 1,
labels = c("Weekend", "Weekday"))
tmpDays = weekdays(data$date)
data$date = as.Date(data$date) # Convert date factor to date
tmpDays = weekdays(data$date)
weekFactor = factor(as.numeric(tmpDays == "Saturday" || tmpDays == "Sunday") + 1,
labels = c("Weekend", "Weekday"))
as.numeric(tmpDays == "Saturday" || tmpDays == "Sunday") + 1
tmpDays == "Saturday"
tmpDays == "Saturday" || tmpDays == "Sunday"
tmpDays == "Saturday" | tmpDays == "Sunday"
as.numeric(tmpDays == "Saturday" | tmpDays == "Sunday") + 1
weekFactor = factor(as.numeric(tmpDays == "Saturday" | tmpDays == "Sunday") + 1,
labels = c("Weekend", "Weekday"))
weekFactor
weekFactor = factor(as.numeric(tmpDays == "Saturday" | tmpDays == "Sunday") + 1,
labels = c("Weekday", "Weekend"))
weekFactor[1:10]
tmpDays = weekdays(data$date)
weekFactor = factor(as.numeric(tmpDays == "Saturday" | tmpDays == "Sunday") + 1,
labels = c("Weekday", "Weekend"))
data = data[, weekFac:=weekFactor]
stepsPerWeekday = data[, lapply(.SD, mean, na.rm = TRUE), by = weekFac]
tmpTime = stepsPerWeekday$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
tmpTime = format(strptime(tmpTime, format = "%H%M"), format = "%H:%M")
sizeX = length(stepsPerWeekday$interval)
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 24) , labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
stepsPerWeekday = data[, lapply(.SD, mean, na.rm = TRUE), by =c(interval,weekFac)]
stepsPerWeekday = data[, lapply(.SD, mean, na.rm = TRUE), by =c("interval","weekFac")]
tmpTime = stepsPerWeekday$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
tmpTime = format(strptime(tmpTime, format = "%H%M"), format = "%H:%M")
sizeX = length(stepsPerWeekday$interval)
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 24) , labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 12) , labels=tmpTime[seq(1,sizeX,12)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 50) , labels=tmpTime[seq(1,sizeX,50)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
View(stepsPerWeekday)
stepsPerWeekday = data[, lapply(.SD, mean, na.rm = TRUE), by =c("interval")]
tmpTime = stepsPerWeekday$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
tmpTime = format(strptime(tmpTime, format = "%H%M"), format = "%H:%M")
sizeX = length(stepsPerWeekday$interval)
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 50) , labels=tmpTime[seq(1,sizeX,50)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
stepsPerWeekday = data[, lapply(.SD, mean, na.rm = TRUE), by =c("interval", "weekFac")]
tmpTime = stepsPerWeekday$interval
tmpTime2 = mapply(function(x, y) paste0(rep(x, y), collapse = ""), 0, 4 - nchar(tmpTime))
tmpTime = paste0(tmpTime2, tmpTime)
tmpTime = format(strptime(tmpTime, format = "%H%M"), format = "%H:%M")
sizeX = length(stepsPerWeekday$interval)
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 50) , labels=tmpTime[seq(1,sizeX,50)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
sizeX = length(stepsPerWeekday$interval)/2
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 50) , labels=tmpTime[seq(1,sizeX,50)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
sizeX = 288
ggplot(stepsPerWeekday, aes(x=seq(1, sizeX,1), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 50) , labels=tmpTime[seq(1,sizeX,50)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
View(stepsPerWeekday)
sizeX = 288
ggplot(stepsPerWeekday, aes(x=c(seq(1, sizeX,1), seq(1, sizeX,1)), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 50) , labels=tmpTime[seq(1,sizeX,50)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
ggplot(stepsPerWeekday, aes(x=c(seq(1, sizeX,1), seq(1, sizeX,1)), y=steps)) +
geom_line() +
facet_grid(weekFac ~ .) +
scale_x_continuous(breaks = seq(1,sizeX, 24) , labels=tmpTime[seq(1,sizeX,24)]) +
theme_bw() +
xlab("Time") +
ylab("Steps")
